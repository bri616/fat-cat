<html>
<head>
    <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
</head>
<body>
<select id="food-menu" name="select">
<option value="0"></option>
</select>
<input type="number" id="wet-food-in-g"></input>
</body>
<div class="wet-food-container">
    <span id="kcal-of-wet-food">0</span>
    <span class="units">kCal</span>
</div>
<div class="dry-food-container">
    <span id="g-of-dry-food">0</span>
    <span class="units">g</span>
</div>
<script>

var currentWetFoodType = "";

var kcalPerFeeding = 160;
var kcalPerKgDryFood = 3825;
//var kcalPerKgDryFood = 2857;
var wetFoods = {};

function myBruce(stuff) {
    bruce = stuff.feed.entry;
    for (var i = 0; i < bruce.length; i++) {
         wetFoods[bruce[i].title.$t] = parseFloat(bruce[i].content.$t.split(" ")[1]);
    };
    buildFoodMenu();   
};

function buildFoodMenu() {
    $.each(wetFoods, function(key, value) {   
         $('#food-menu')
             .append($("<option></option>")
             .attr("value",value)
             .text(key)); 
    });
};

$(document).on('change', "#food-menu", function(e) {
    //console.log(this.options[e.target.selectedIndex].value);
	currentWetFoodType = this.options[e.target.selectedIndex].text;
});

function calcWetFoodKCal(wetFoodType, g) {
	var kcalPerKg = wetFoods[wetFoodType]
	return kcalPerKg/1000*g
};

function calcNeededDryFoodInG(kcalPerFeeding, kcalPerKgDryFood, kcalWetFood) {
	kgDryFood = (kcalPerFeeding - kcalWetFood) / kcalPerKgDryFood;
	return kgDryFood*1000
};

$(document).on('keyup', "#wet-food-in-g", function() {
	console.log(currentWetFoodType)
	$("#kcal-of-wet-food")[0].innerHTML=Math.round(calcWetFoodKCal(currentWetFoodType,this.value));
	$("#g-of-dry-food")[0].innerHTML=Math.round(calcNeededDryFoodInG(kcalPerFeeding, kcalPerKgDryFood, calcWetFoodKCal(currentWetFoodType, this.value)));
});
</script>
<script src="https://spreadsheets.google.com/feeds/list/14e4-F9rcLuyZ71so6S4E-QrcXHTjO8907BVZiR3mH2k/od6/public/basic?alt=json-in-script&callback=myBruce"></script>
</html>
